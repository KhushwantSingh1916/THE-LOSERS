<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Escape The School</title>
    <style>
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            color: #fff;
            text-align: center;
        }

        body {
            background-image: url('https://images.unsplash.com/photo-1579684453429-6400a9c043a0?auto=format&fit=crop&w=1950&q=80');
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
        }

        #doorsScreen {
            background-image: url('/door.jpg');
        }

        #startScreen {
            background-image: url('/mainbg.jpg');
            background-size: cover;
        }

        #loginScreen {
            background-image: url('/login.jpg');
            background-size: cover;
        }

        #questionContainer {
            background-image: url('/text.jpg');
            background-size: cover;
        }
        #finalScreen{
            background-image: url('/freedom.jpg');
            background-size: cover;
        }

        h1 {
            font-size: 46px;
            margin-bottom: 30px;
            text-shadow: 2px 2px 5px #000;
        }

        .start-button {
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
            padding: 10px;
            background: #13c2ab;
            text-decoration: none;
            border: none;
            border-radius: 4px;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.65);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        h2#questionText {
            background-color: white;
            color: #000;
            padding: 20px;
            width: 50vw;
            border-radius: 5px;
        }

        .doors-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-size: cover;
            background-position: center;
        }

        .doors {
            display: flex;
            gap: 169px;
        }

        .door {

            width: 22pc;
            height: 37pc;
            padding: 20px;
            text-align: center;
            color: white;
            font-size: 38px;
            display: flex;
            align-items: top;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s;
            margin-left: 63px;

        }

        .door.completed {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .door:hover:not(.completed) {
            transform: scale(1.1);
        }

        .question-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
        }

        #feedback {
            margin-top: 10px;
            font-size: 20px;
        }

        .points-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 18px;
        }

        .final-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            text-align: center;
        }

        .final-screen h1 {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .final-screen p {
            font-size: 24px;
            margin-bottom: 30px;
        }

        .final-screen button {
            padding: 12px 24px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .final-screen button:hover {
            background-color: #45a049;
        }

        input,
        select,
        button {
            padding: 8px 16px;
            margin: 5px;
            font-size: 16px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        button {
            border: none;
            cursor: pointer;
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
            padding: 10px;
            background: #13c2ab;
            text-decoration: none;
            border-radius: 4px;
        }

        button:hover {
            background: #13c2ab;
        }
    </style>
</head>

<body>
    <div class="points-display">Points: <span id="pointsCounter">0</span></div>

    <div id="startScreen" class="overlay">
        <h1>Escape The School</h1>
        <p style="font-size: larger;   text-shadow: 2px 2px 5px #000;" >You are trapped in a mysterious school. Solve subject-related puzzles to unlock doors and find your way out!
        </p>
        <button class="start-button" onclick="goToLogin()">Start The Game</button>
    </div>

    <div id="loginScreen" class="overlay" style="display:none;">
        <h1>Enter Your Details</h1>
        <div>
            <input type="text" id="username" placeholder="Enter your username" required>
            <select id="classSelect" required>
                <option value="">Select your class</option>
                <option value="6">6th</option>
                <option value="7">7th</option>
                <option value="8">8th</option>
                <option value="9">9th</option>
                <option value="10">10th</option>
            </select>
            <button class="login-button" onclick="startGame()">Start</button>
        </div>
    </div>

    <div id="doorsScreen" class="doors-screen">
        <h1>Select a Subject to Escape</h1>
        <div class="doors">
            <div class="door" onclick="startQuiz('Math')">Maths</div>
            <div class="door" onclick="startQuiz('Physics')">Physics</div>
            <div class="door" onclick="startQuiz('Chemistry')">Chemistry</div>
        </div>
    </div>

    <div id="questionContainer" class="question-container">
        <h2 style="font-size: larger;   text-shadow: 2px 2px 5px #000;" id="storyText"></h2>
        <h2 id="questionText">Question</h2>
        <input type="text" id="answerInput" placeholder="Enter your answer">
        <button onclick="checkAnswer()">Submit</button>
        <p id="feedback"></p>
    </div>

    <div id="finalScreen" class="final-screen">
        <h1>Congratulations!</h1>
        <p id="finalScore"></p>
        <button onclick="resetGame()">play Again</button>
    </div>

    <script>
        let currentSubject = "";
        let questionIndex = 0;
        let classLevel = "";
        let points = 0;
        let completedRooms = new Set();
        const questions = {
            Math: {
                6: {
                    question: [
                        "As you step into the Maths Room, you see a large, mysterious treasure chest in the center. On the wall beside it, a puzzle is boldly written: 'What is 5 + 7?'",
                        "The chest reveals an ornate balance scale on a pedestal. An inscription reads: 'Place double the number you found on the scale.'",
                        "With the key in hand, a hidden door materializes along the wall. Etched on its surface is a puzzle: 'Divide 36 by 6, then multiply the result by 2.'",
                        "Inside, you find a simple wooden table with a neatly folded piece of paper resting atop it. The paper bears a challenge: 'Find the missing number in the sequence: 4, 8, __, 16, 20.'",
                        "Near the exit, a small lock secures a door promising freedom. On it, a final puzzle is inscribed: 'Multiply the number of legs on 3 chairs by the number of wheels on 2 bicycles.'"
                    ],
                    answer: ["12", "24", "12", "12", "48"]
                },
                7: {
                    question: [
                        "You enter a dimly lit room where an ancient weighing machine stands. On a table, there's a basket of apples. A voice echoes: 'Two apples and three apples make... What?'",
                        "The apples float and land gently on the weighing machine. A piece of paper appears with the equation: '2x + 3 = 11'. Solve the equation.",
                        "A bookshelf rumbles, and an ancient book opens to reveal: 'Multiply the number of books in this room by 3, then subtract the number of apples you just placed. Find the result.'",
                        "The book opens to a new page with the clue: 'Divide the sum of the books and apples by 2. Then add 1.'",
                        "The final clue appears: 'The number of apples on the scale multiplied by the number of pages turned so far equals what?'"
                    ],
                    answer: ["5", "4", "13", "6", "15"]
                }
            },
            Physics: {
                6: {
                    question: [
                        "What do we call a push or pull on an object?",
                        "Which simple machine is used to lift heavy objects using a rope and wheel?",
                        "Blow air across this table. Watch carefully! The piece of paper moves without touching it. What causes this movement?",
                        "Why do we hear the sound coming back? What is this effect called?",
                        "The Sun gives us heat and light. What kind of energy does it provide?",
                    ],
                    answer: ["force", "pulley", "air", "echo", "solar"]
                },
                7: {
                    question: [
                        "Identify the force that anchors you to the Earth.",
                        "Name the phenomenon that causes the light to bend.",
                        "This substance flows freely yet holds its volume. What state of matter is it?",
                        "What term describes the number of cycles per second of that pulse?",
                        "Name the device that brings distant celestial bodies into focus."
                    ],
                    answer: ["gravity", "refraction", "liquid", "frequency", "telescope"]
                }
            },
            Chemistry: {
                6: {
                    question: [
                        "What is H2O commonly known as?",
                        "What element does 'Na' represent?",
                        "What gas do we breathe in to stay alive?",
                        "Among all the elements, one is used to make jewelry because it is shiny and valuable. Name it.",
                        "Water boils at how many degrees Celsius?",
                    ],
                    answer: ["water", "sodium", "oxygen", "gold", "100"]
                },
                7: {
                    question: [
                        "Almost 78% of the air is made of this gas. Name it.",
                        "Lemons are sour because they contain which acid?",
                        "Most metals are solid at room temperature, but this one is liquid. Name it.",
                        "Iron reacts with water and oxygen to form what?",
                        "Which gas is essential for fire to burn?",
                    ],
                    answer: ["nitrogen", "citric", "mercury", "rust", "oxygen"]
                }
            },
        };

        function updatePointsDisplay() {
            document.getElementById("pointsCounter").textContent = points;
        }

        function goToLogin() {
            document.getElementById("startScreen").style.display = "none";
            document.getElementById("loginScreen").style.display = "flex";
        }

        function startGame() {
            classLevel = document.getElementById("classSelect").value;
            if (classLevel === "") {
                alert("Please select your class.");
                return;
            }
            document.getElementById("loginScreen").style.display = "none";
            document.getElementById("doorsScreen").style.display = "flex";
        }

        function typeQuestionText(text, elementId, speed = 50) {
            let i = 0;
            const element = document.getElementById(elementId);
            element.innerHTML = "";
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        function startQuiz(subject) {
            if (completedRooms.has(subject)) {
                alert("You've already completed this room!");
                return;
            }

            currentSubject = subject;
            questionIndex = 0;
            document.getElementById("doorsScreen").style.display = "none";
            document.getElementById("questionContainer").style.display = "flex";
            if (subject === "Math") {
                if (classLevel === "7") {
                    document.getElementById("storyText").innerText = "Welcome to the Maths Room – Apple Puzzle";
                } else if (classLevel === "6") {
                    document.getElementById("storyText").innerText = "Welcome to the Maths Room – 5-Step Challenge";
                } else {
                    document.getElementById("storyText").innerText = "You find an old locked door. A mysterious voice whispers, 'Answer correctly to escape...'";
                }
            }
            if (subject === "Physics") {
                if (classLevel === "7") {
                    document.getElementById("storyText").innerText = "Welcome to the Physics Lab – Enigma of Light and Motion";
                } else if (classLevel === "6") {
                    document.getElementById("storyText").innerText = "Welcome to the Physics Room – The Mysterious Lab";
                }
            }
            if (subject === "Chemistry") {
                if (classLevel === "6") {
                    document.getElementById("storyText").innerText = "Welcome to the Chemistry Lab – The Chemical Play";
                } else if (classLevel === "7") {
                    document.getElementById("storyText").innerText = "Welcome to the Chemistry Lab – The Junior Scientist";
                }
            }
            typeQuestionText(questions[subject][classLevel].question[questionIndex], "questionText");
            document.getElementById("answerInput").value = "";
            document.getElementById("feedback").innerText = "";
        }

        function checkAnswer() {
            let userAnswer = document.getElementById("answerInput").value.trim().toLowerCase();
            let correctAnswer = questions[currentSubject][classLevel].answer[questionIndex].toLowerCase();

            if (userAnswer === correctAnswer) {
                points += 2;
                document.getElementById("feedback").innerText = "Correct! 🎉 (+2 points)";
            } else {
                points = Math.max(0, points - 1); // Prevent negative points
                document.getElementById("feedback").innerText = "Incorrect. Try again! ❌ (-1 point)";
                updatePointsDisplay();
                return;
            }

            updatePointsDisplay();
            questionIndex++;

            if (questionIndex < questions[currentSubject][classLevel].question.length) {
                typeQuestionText(questions[currentSubject][classLevel].question[questionIndex], "questionText");
                document.getElementById("answerInput").value = "";
            } else {
                completedRooms.add(currentSubject);
                const doorElement = Array.from(document.getElementsByClassName('door'))
                    .find(door => door.textContent.includes(currentSubject));
                if (doorElement) {
                    doorElement.classList.add('completed');
                }

                if (completedRooms.size === 3) {
                    showFinalScreen();
                } else {
                    alert("You have escaped the " + currentSubject + " room!");
                    document.getElementById("questionContainer").style.display = "none";
                    document.getElementById("doorsScreen").style.display = "flex";
                }
            }
        }

        function showFinalScreen() {
            document.getElementById("questionContainer").style.display = "none";
            document.getElementById("doorsScreen").style.display = "none";
            document.getElementById("finalScreen").style.display = "flex";
            document.getElementById("finalScore").textContent = "You Escaped the School with ${points} points!";
        }

        function resetGame() {
            // Reset all game variables
            points = 0;
            currentSubject = "";
            questionIndex = 0;
            classLevel = "";
            completedRooms = new Set();

            // Reset UI elements
            updatePointsDisplay();
            document.getElementById("username").value = "";
            document.getElementById("classSelect").value = "";
            document.getElementById("answerInput").value = "";
            document.getElementById("feedback").innerText = "";

            // Remove completed class from all doors
            document.querySelectorAll('.door').forEach(door => {
                door.classList.remove('completed');
            });

            // Hide all screens except start screen
            document.getElementById("finalScreen").style.display = "none";
            document.getElementById("questionContainer").style.display = "none";
            document.getElementById("doorsScreen").style.display = "none";
            document.getElementById("loginScreen").style.display = "none";
            document.getElementById("startScreen").style.display = "flex";
        }
    </script>
</body>

</html>
